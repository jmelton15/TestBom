@Grab(group='org.apache.poi', module='poi', version='4.1.2')
@Grab(group='org.apache.poi', module='poi-ooxml', version='4.1.2')

import org.apache.poi.ss.usermodel.*

pipeline {
    agent any

    stages {
        stage("Setup Temp Folders") {
            steps {
                script {
                    def cmd1 = 'mkdir BOM_FILES'
                    def cmd2 = 'mkdir Repos'
                    def process1 = bat(script:cmd1,returnStatus: true)
                    if(process1 == 0) {
                        echo "Created Bom File Folder"
                    } else {
                        echo "Creating Bom File Folder failed with code: ${process1}"
                    }
                }
            }
        }
        stage("Read xlsx file") {
            steps {
                script {
                    def excelFile = 'test.xlsx'

                    FileInputStream inputStream = new FileInputStream(excelFile)
                    Workbook workbook = WorkbookFactory.create(inputStream)
                    Sheet sheet = workbook.getSheetAt(0)
                    def urlColumn = 1
                    def branchColumn = 2

                    for(Row row : sheet) {
                        Cell urlCell = row.getCell(urlColumn)
                        if(cell != null) {
                            echo "Cell Value: ${urlCell}"
                        }
                    }
                }
            }
        }
        
    }
}